bundle:
  name: dbx-bundle-poc

workspace:
  root_path: /Workspace/Users/rohitazure9@gmail.com/.bundle/${bundle.name}/${bundle.target}

include:
  - conf/*.yml

variables:
  catalog: main        # default
  schema: default      # default

resources:
  jobs:
    etl_demo_job:
      name: dbx-bundle-poc-${bundle.target}-etl
      tasks:
        - task_key: create_demo_table
          notebook_task:
            notebook_path: ${workspace.root_path}/files/notebooks/00_create_demo_table.py
        - task_key: etl_demo
          depends_on: [create_demo_table]
          notebook_task:
            notebook_path: ${workspace.root_path}/files/notebooks/10_etl_demo.py
        - task_key: transform_sales
          depends_on: [etl_demo]
          notebook_task:
            notebook_path: ${workspace.root_path}/files/notebooks/20_transform_sales.py

  files:
    notebooks:
      source: notebooks
      path: ${workspace.root_path}/files/notebooks

targets:
  dev:
    default: true
    workspace:
      host: ${env.DATABRICKS_HOST}
    run_as:
      user_name: rohitazure9@gmail.com
    variables:
      catalog: dev_catalog
      schema: dev_schema

  qa:
    workspace:
      host: ${env.DATABRICKS_HOST}
    run_as:
      user_name: rohitazure9@gmail.com
    variables:
      catalog: qa_catalog
      schema: qa_schema

  prod:
    workspace:
      host: ${env.DATABRICKS_HOST}
    run_as:
      user_name: rohitazure9@gmail.com
    variables:
      catalog: prod_catalog
      schema: prod_schema
